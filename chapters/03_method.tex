% !TeX root = ../main.tex
% Add the above to each chapter to make compiling the PDF easier in some editors.
\chapter{Methodology}\label{chapter:method}

In order to address the problem and test our hypothesis, we developed a setup in which we collect and locally aggregate location data on end user devices (smartphones). The raw data will stay on each device and will be only used to serve aggregation requests from a central server. The aggregation requests have to be defined upfront. An example is the determination of the average steps per day by each user. An incoming aggregation request might look like
\begin{verbatim}
{
	"n" : 3
	"value": 2000
}
\end{verbatim}
And the data contained in the outgoing response after processing the request might look like
\begin{verbatim}
{
	"n" : 4
	"value": 2500
}
\end{verbatim}
 In order to protect the user's privacy and shield the raw data from the server, it would be necessary to pass the request P2P from one device to another until the last device final publishes the result to the server. P2P on mobile phones though is hardly possible. Nevertheless, we found a way to simulate P2P: On installation, every installed application registers at the server with a public key. The corresponding private key is stored locally. When one end user device needs to send the processed aggregation request to the next phone, it encrypts the data using that phones public key in the standard hybrid encryption approach leveraging the benefits of synchronous keys. This way the next phone will be able to decrypt the request and process the data while the server is unable to read the data until the aggregation request is finally send unencrypted for publishing to the server. This process is depicted in XX.

 The aggregated results are available only to our research team in order to protect the research participants privacy in case there is a privacy risk we have not thought of but the setting allows for them being available to the public. The aggregation requsts themselves are controlled by our research team and inserted on a daily basis.

\includegraphics[width=\textwidth]{data/concept.jpg}

